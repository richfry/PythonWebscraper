__author__ = 'Richard Fry'


import urllib2, urllib
import re
from bs4 import BeautifulSoup
#import csv
import unicodedata
import unicodecsv as csv

##http://www.burrows.co.uk/scripts_AA/db4_IBAA_09.dll/next_prev?PAGE=0&SID=40598917
##http://www.buburrows.co.uk/scripts_AA/db4_IBAA_09.dll/sf?who=**&what=&where=e.g.:+Lancaster+Road&sortby_=name&Searchbutton=Search&whatfrompopup=&SID=40598917


headers = ""
Companies = []

##Query the server to get the search results from the database
##Swansea
#URL = "http://www.burrows.co.uk/scripts/db4_ibaa_09.dll/setdb?database=307928"
##Bristol
#URL = "http://www.burrows.co.uk/scripts/db4_ibaa_09.dll/setdb?database=308139"

##Neath Port Talbot
URL = "http://www.npt-business.co.uk/default.aspx?page=3244"


headers = {
    'Host': 'www.npt-business.co.uk',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
    'Accept-Language': 'en-US,en;q=0.5',
    'Accept-Encoding': 'gzip, deflate',
    'DNT': '1',
    'Referer': 'http://www.npt-business.co.uk/default.aspx?page=3244',
    'Cookie': 'ASP.NET_SessionId=yxghxszoj4zhofvxovcmz455; _ga=GA1.3.1279997152.1454064307; _gali=Template_ctl20_ctl00_Submit',
    'Connection': 'keep-alive'
}

data = {
    'Template$AutoId8$AutoId9$quickSearch':'Search',
'Template$RatingForm$Captcha':'',
'Template$RatingForm$txtDetail':'',
'Template$RatingForm$txtEmail':'',
'Template$RatingForm$txtEmailConfirm':'',
'Template$ctl20$ctl00$DropDownListPark':'',
'Template$ctl20$ctl00$DropDownListRange':'',
'Template$ctl20$ctl00$Submit':'Submit',
'Template$ctl20$ctl00$txtBusinessName':'',
'Template$sharebox$hidCC':'',
'Template$sharebox$hidCS':'',
'__EVENTARGUMENT':'',
'__EVENTTARGET':'',
'__EVENTVALIDATION':'/wEWTwL/2qf6DwK3ppvyBgK36fXEBQLWicCRBALSk66KDAKfmLvpCQKcuPTCBQL6ivXUAQLxsKHMDAKmhpflCAKowqpPAs+B56sMAouDvuEIApuQ290PAuKb7uAGAv7QwqAEAo6yv50CAo2hj8kMAr2WpsYLAqL9uuUCArrAj8IKAvjg9tULArbo7OgIArPvzo4GAseX3MsIAsfx34AGAt///a8KArTm5uEIAvWv44EHArqgkaYBAqPrut0BAtfG19APAvrD68QPAriIjssJAtvN34UFAo+AisoDAs7g9tgJAuKJ5KUBAvLmjsgNAvLmssgNAu3mjsgNAu3mssgNAuzmjsgNAuzmssgNAu/mjsgNAu/mssgNAu7mjsgNAunmjsgNAunmssgNAujmjsgNAujmssgNAuvmjsgNAuvmssgNAvrmjsgNAvrmssgNAri8rbYOArfQg9kHAoe9poUFAuKU16AFArmcsv8MAtjustUIAo7pgvAJAsLY1/APAoSm+Y4BAtmEjKEIAsHh1ugJAs+s8skNArialf0CAor02Z8PAq/SjIUOAvaHi+IIArjS9KoJAvT3jaUPAvDZuIkEAuCgltMMAqvytrgIAput180BAvjzg90MAte2hpsDGmTcdUhROHICew99ot6gTrpPRFM=',
'__VIEWSTATE':'/wEPDwUENTM4MQ9kFgJmD2QWBAICD2QWCgIBDxYCHgRocmVmBcQBL1dlYlJlc291cmNlLmF4ZD9kPUg2MjYyOTMzVEZmY3A0dUJKYzhBNkxDNHFqOFZ5aWpUR0hoSXVhQkgyVThVQ0F3a0hnajVHQ2dPMk9mR1F1SU1oWDRkZThRcnc4emVhSUNsaGU4YXEweDhDUGpGWnc4Ym8wak9ydU5FVnRRajNlbnBYX2g1QUVWTllEc0FOa0hoaldEZnZHRHNobzF1NTMtOWtZd2VNYkpnM19RMSZ0PTYzNTg1NDI2MjIxMzk1Mzg1MmQCFw8WAh8ABSsvdGVtcGxhdGVzL2RlZmF1bHQvY3NzL3N5c3RlbS9ucHRTdHlsZXMuY3NzZAIZDxYCHwAFLy90ZW1wbGF0ZXMvZGVmYXVsdC9jc3MvbnB0TlBUQnVzaW5lc3NTdHlsZXMuY3NzZAIeDxYCHwAFHi90ZW1wbGF0ZXMvZGVmYXVsdC9mYXZpY29uLmljb2QCIA9kFgJmDxYCHgRUZXh0BdADDQo8c2NyaXB0Pg0KICAoZnVuY3Rpb24oaSxzLG8sZyxyLGEsbSl7aVsnR29vZ2xlQW5hbHl0aWNzT2JqZWN0J109cjtpW3JdPWlbcl18fGZ1bmN0aW9uKCl7DQogICAgKGlbcl0ucT1pW3JdLnF8fFtdKS5wdXNoKGFyZ3VtZW50cyl9LGlbcl0ubD0xKm5ldyBEYXRlKCk7YT1zLmNyZWF0ZUVsZW1lbnQobyksDQogICAgIG09cy5nZXRFbGVtZW50c0J5VGFnTmFtZShvKVswXTthLmFzeW5jPTE7YS5zcmM9ZzttLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGEsbSkNCiAgIH0pKHdpbmRvdyxkb2N1bWVudCwnc2NyaXB0JywnLy93d3cuZ29vZ2xlLWFuYWx5dGljcy5jb20vYW5hbHl0aWNzLmpzJywnZ2EnKTsNCg0KICBnYSgnY3JlYXRlJywgJ1VBLTQ0NDk5Ni00JywgJ2F1dG8nKTsNCiAgZ2EoJ3JlcXVpcmUnLCAnbGlua2lkJywgJ2xpbmtpZC5qcycpOw0KICBnYSgnc2VuZCcsICdwYWdldmlldycpOw0KPC9zY3JpcHQ+DQpkAgMPZBYIAgwPZBYCZg9kFgICAQ9kFg5mDw8WAh8BBQ5CdXNpbmVzcyBOYW1lOmRkAgIPDxYCHwEFDkJ1c2luZXNzIFBhcms6ZGQCAw8QDxYEHhRBcHBlbmREYXRhQm91bmRJdGVtc2ceC18hRGF0YUJvdW5kZ2QPFiJmAgECAgIDAgQCBQIGAgcCCAIJAgoCCwIMAg0CDgIPAhACEQISAhMCFAIVAhYCFwIYAhkCGgIbAhwCHQIeAh8CIAIhFiIQBRJBbGwgQnVzaW5lc3MgUGFya3NlZxAFHEFiYmV5IFJvYWQgSW5kdXN0cmlhbCBFc3RhdGUFHEFiYmV5IFJvYWQgSW5kdXN0cmlhbCBFc3RhdGVnEAUeQWJlcm5hbnQgQ2VudHJlIGZvciBFbnRlcnByaXNlBR5BYmVybmFudCBDZW50cmUgZm9yIEVudGVycHJpc2VnEAUtQWxsb3kgSW5kdXN0cmlhbCBFc3RhdGUvQ3dtdGF3ZSBCdXNpbmVzcyBQYXJrBS1BbGxveSBJbmR1c3RyaWFsIEVzdGF0ZS9Dd210YXdlIEJ1c2luZXNzIFBhcmtnEAUSQmFnbGFuIEVuZXJneSBQYXJrBRJCYWdsYW4gRW5lcmd5IFBhcmtnEAUYQmFnbGFuIEluZHVzdHJpYWwgRXN0YXRlBRhCYWdsYW4gSW5kdXN0cmlhbCBFc3RhdGVnEAUNQnJpdGFubmljIFdheQUNQnJpdGFubmljIFdheWcQBRhCcnVuZWwgSW5kdXN0cmlhbCBFc3RhdGUFGEJydW5lbCBJbmR1c3RyaWFsIEVzdGF0ZWcQBRpDcm9lc2VydyBJbmR1c3RyaWFsIEVzdGF0ZQUaQ3JvZXNlcncgSW5kdXN0cmlhbCBFc3RhdGVnEAUVQ3J5bmFudCBCdXNpbmVzcyBQYXJrBRVDcnluYW50IEJ1c2luZXNzIFBhcmtnEAURQ3dtZ29ycyBXb3Jrc2hvcHMFEUN3bWdvcnMgV29ya3Nob3BzZxAFBEVDTTIFBEVDTTJnEAUUR2x5bmNvcnJ3ZyBXb3Jrc2hvcHMFFEdseW5jb3Jyd2cgV29ya3Nob3BzZxAFF0dseW5uZWF0aCBCdXNpbmVzcyBQYXJrBRdHbHlubmVhdGggQnVzaW5lc3MgUGFya2cQBRtHcmVlbiBQYXJrIEluZHVzdHJhbCBFc3RhdGUFG0dyZWVuIFBhcmsgSW5kdXN0cmFsIEVzdGF0ZWcQBRhHdXJub3MgSW5kdXN0cmlhbCBFc3RhdGUFGEd1cm5vcyBJbmR1c3RyaWFsIEVzdGF0ZWcQBRhIZW5zaGF3IFN0cmVldCBXb3Jrc2hvcHMFGEhlbnNoYXcgU3RyZWV0IFdvcmtzaG9wc2cQBRhLZW5maWcgSW5kdXN0cmlhbCBFc3RhdGUFGEtlbmZpZyBJbmR1c3RyaWFsIEVzdGF0ZWcQBRdMbGFuZGFyY3kgQnVzaW5lc3MgUGFyawUXTGxhbmRhcmN5IEJ1c2luZXNzIFBhcmtnEAUPTGxld2VsbHlucyBRdWF5BQ9MbGV3ZWxseW5zIFF1YXlnEAUZTG9uIEhpciBJbmR1c3RyaWFsIEVzdGF0ZQUZTG9uIEhpciBJbmR1c3RyaWFsIEVzdGF0ZWcQBRdMb25sYXMgVmlsbGFnZSBXb3Jrc2hvcAUXTG9ubGFzIFZpbGxhZ2UgV29ya3Nob3BnEAUeTWlsbGFuZCBSb2FkIEluZHVzdHJpYWwgRXN0YXRlBR5NaWxsYW5kIFJvYWQgSW5kdXN0cmlhbCBFc3RhdGVnEAUOTW9uYXN0ZXJ5IFJvYWQFDk1vbmFzdGVyeSBSb2FkZxAFAk5BBQJOQWcQBRlOZWF0aCBBYmJleSBCdXNpbmVzcyBQYXJrBRlOZWF0aCBBYmJleSBCdXNpbmVzcyBQYXJrZxAFHFBvbnRhcmRhd2UgSW5kdXN0cmlhbCBFc3RhdGUFHFBvbnRhcmRhd2UgSW5kdXN0cmlhbCBFc3RhdGVnEAUoUG9ydCBUYWxib3QgQnVzaW5lc3MgVW5pdHMsIEFkZGlzb24gUm9hZAUoUG9ydCBUYWxib3QgQnVzaW5lc3MgVW5pdHMsIEFkZGlzb24gUm9hZGcQBSFQb3J0IFRhbGJvdCBEb2NrcyBJbmR1c3RyaWFsIEFyZWEFIVBvcnQgVGFsYm90IERvY2tzIEluZHVzdHJpYWwgQXJlYWcQBTBQdXJjZWxsIEF2ZW51ZS9FbmRlYXZvdXIgQ2xvc2UgSW5kdXN0cmlhbCBFc3RhdGUFMFB1cmNlbGwgQXZlbnVlL0VuZGVhdm91ciBDbG9zZSBJbmR1c3RyaWFsIEVzdGF0ZWcQBRpTYW5kZmllbGRzIEJ1c2luZXNzIENlbnRyZQUaU2FuZGZpZWxkcyBCdXNpbmVzcyBDZW50cmVnEAUfU2Vhd2F5IFBhcmFkZSBJbmR1c3RyaWFsIEVzdGF0ZQUfU2Vhd2F5IFBhcmFkZSBJbmR1c3RyaWFsIEVzdGF0ZWcQBQxUb25tYXdyIDIwMDAFDFRvbm1hd3IgMjAwMGcQBRtWYWxlIG9mIE5lYXRoIEJ1c2luZXNzIFBhcmsFG1ZhbGUgb2YgTmVhdGggQnVzaW5lc3MgUGFya2dkZAIEDw8WAh8BBQ9FbXBsb3llZSBSYW5nZTpkZAIFDxAPFgQfAmcfA2dkDxYSZgIBAgICAwIEAgUCBgIHAggCCQIKAgsCDAINAg4CDwIQAhEWEhAFE0FsbCBFbXBsb3llZSBSYW5nZXNlZxAFE05vdCBLbm93biBFbXBsb3llZXMFAjAwZxAFDygxLTUpIEVtcGxveWVlcwUCMDVnEAUQKDYtMTApIEVtcGxveWVlcwUCMTBnEAURKDExLTE1KSBFbXBsb3llZXMFAjE1ZxAFESgxNi0yMCkgRW1wbG95ZWVzBQIyMGcQBREoMjEtMjUpIEVtcGxveWVlcwUCMjVnEAURKDI2LTUwKSBFbXBsb3llZXMFAjMwZxAFESg1MS03NSkgRW1wbG95ZWVzBQIzNWcQBRIoNzYtMTAwKSBFbXBsb3llZXMFAjQwZxAFEygxMDEtMTUwKSBFbXBsb3llZXMFAjUwZxAFEygxNTEtMjAwKSBFbXBsb3llZXMFAjU1ZxAFEygyMDEtMjUwKSBFbXBsb3llZXMFAjYwZxAFEygyNTEtNTAwKSBFbXBsb3llZXMFAjY1ZxAFEyg1MDEtNzUwKSBFbXBsb3llZXMFAjcwZxAFFCg3NTEtMTAwMCkgRW1wbG95ZWVzBQI3NWcQBRUoMTAwMS01MDAwKSBFbXBsb3llZXMFAjgwZxAFESg1MDAwKykgRW1wbG95ZWVzBQI4NWdkZAIGDw9kFgIeCm9ua2V5cHJlc3MFMGphdmFzY3JpcHQ6aWYgKGV2ZW50LmtleUNvZGU9PTEzKXt0aGlzLmNsaWNrKCk7fWQCBw8WAh4LXyFJdGVtQ291bnQCBxYQZg9kFgJmDxUBLDxwPlRoZXJlIGFyZSA8c3Ryb25nPjc8L3N0cm9uZz4gUmVzdWx0cy48L3A+ZAIBD2QWBGYPFQ0CNzERQi5BLlIuIFByb3BzaGFmdHNrPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+QWRkcmVzczo8L3RoPjx0ZD5Vbml0IDMsPGJyIC8+QWJiZXkgUm9hZCBJbmR1c3RyaWFsIEVzdGF0ZSw8YnIgLz5OZWF0aDwvdGQ+PC90cj6nAjx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPlBvc3Rjb2RlOjwvdGg+PHRkPjxhIHRpdGxlPSdWaWV3IHRoaXMgYXJlYSBvbiBHb29nbGUgTWFwcycgaHJlZj0naHR0cDovL21hcHMuZ29vZ2xlLmNvLnVrL21hcHM/c291cmNlaWQ9bmF2Y2xpZW50JmFtcDtpZT1VVEYtOCZhbXA7cmx6PTFUNEdGUkNfZW5HQjIyMUdCMjIyJmFtcDtxPVNBMTAgN0ROJz48aW1nIGhlaWdodD0iMTQiIGFsdD0nTG9jYXRlLi4uJyBzcmM9J2ltYWdlcy9zZWFyY2hfaWNvbi5naWYnIHdpZHRoPSIxMyI+IFNBMTAgN0ROPC9hPjwvdGQ+PC90cj5YPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+QnVzaW5lc3MgUGFyazo8L3RoPjx0ZD5BYmJleSBSb2FkIEluZHVzdHJpYWwgRXN0YXRlPC90ZD48L3RyPkQ8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5UZWxlcGhvbmU6PC90aD48dGQ+MDE2MzkgNjQ2OTIyPC90ZD48L3RyPgAAPjx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPkZheDo8L3RoPjx0ZD4wMTYzOSA2NDY5MjM8L3RkPjwvdHI+ejx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPldlYnNpdGU6PC90aD48dGQ+PGEgaHJlZj0naHR0cDovL3d3dy5iYXJwcm9wc2hhZnRzLmNvLnVrJz53d3cuYmFycHJvcHNoYWZ0cy5jby51azwvYT48L3RkPjwvdHI+QDx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPkVtcGxveWVlIFJhbmdlOjwvdGg+PHRkPjEtNTwvdGQ+PC90cj5FPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+TWFpbiBDb250YWN0OjwvdGg+PHRkPk1yIEEgSm9uZXM8L3RkPjwvdHI+AGQCAQ8WAh8FAgEWBGYPZBYCZg8VARFDb21wYW55IEFjdGl2aXR5OmQCAQ9kFgJmDxUBJ1Byb3BzaGFmdHMgLSBNYW51ZmFjdHVyZS9SZWNvbmRpdGlvbmluZ2QCAg9kFgRmDxUNAjc5H0JhaWxleSdzIFdpbmRvdyBCbGluZHMgb2YgTmVhdGhrPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+QWRkcmVzczo8L3RoPjx0ZD5Vbml0IDcsPGJyIC8+QWJiZXkgUm9hZCBJbmR1c3RyaWFsIEVzdGF0ZSw8YnIgLz5OZWF0aDwvdGQ+PC90cj6nAjx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPlBvc3Rjb2RlOjwvdGg+PHRkPjxhIHRpdGxlPSdWaWV3IHRoaXMgYXJlYSBvbiBHb29nbGUgTWFwcycgaHJlZj0naHR0cDovL21hcHMuZ29vZ2xlLmNvLnVrL21hcHM/c291cmNlaWQ9bmF2Y2xpZW50JmFtcDtpZT1VVEYtOCZhbXA7cmx6PTFUNEdGUkNfZW5HQjIyMUdCMjIyJmFtcDtxPVNBMTAgN0ROJz48aW1nIGhlaWdodD0iMTQiIGFsdD0nTG9jYXRlLi4uJyBzcmM9J2ltYWdlcy9zZWFyY2hfaWNvbi5naWYnIHdpZHRoPSIxMyI+IFNBMTAgN0ROPC9hPjwvdGQ+PC90cj5YPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+QnVzaW5lc3MgUGFyazo8L3RoPjx0ZD5BYmJleSBSb2FkIEluZHVzdHJpYWwgRXN0YXRlPC90ZD48L3RyPkQ8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5UZWxlcGhvbmU6PC90aD48dGQ+MDE2MzkgNjMwMzYyPC90ZD48L3RyPkE8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5Nb2JpbGU6PC90aD48dGQ+MDc5NzMgMjg3NTUzPC90ZD48L3RyPm48dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5FbWFpbDo8L3RoPjx0ZD48YSBocmVmPSdtYWlsdG86bW1iMTk1MUB2aXJnaW4ubmV0Jz5tbWIxOTUxQHZpcmdpbi5uZXQ8L2E+PC90ZD48L3RyPj48dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5GYXg6PC90aD48dGQ+MDE2MzkgNjMwMzYyPC90ZD48L3RyPgBAPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+RW1wbG95ZWUgUmFuZ2U6PC90aD48dGQ+MS01PC90ZD48L3RyPkg8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5NYWluIENvbnRhY3Q6PC90aD48dGQ+TXIgTSBNIEJhaWxleTwvdGQ+PC90cj5OPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+RGVzY3JpcHRpb246PC90aD48dGQ+QmxpbmRzIChtYW51ZmFjdHVyZSk8L3RkPjwvdHI+ZAIBDxYCHwUCARYEZg9kFgJmDxUBEUNvbXBhbnkgQWN0aXZpdHk6ZAIBD2QWAmYPFQEHQmxpbmRzLmQCAw9kFgRmDxUNAzE0OBFDTEFTU0lDQUwgSk9JTkVSWXQ8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5BZGRyZXNzOjwvdGg+PHRkPkN3cnQgSGVyYmVydCBIb3VzZSw8YnIgLz5BYmJleSBSb2FkIEluZHVzdHJpYWwgRXN0LDxiciAvPk5lYXRoPC90ZD48L3RyPqcCPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+UG9zdGNvZGU6PC90aD48dGQ+PGEgdGl0bGU9J1ZpZXcgdGhpcyBhcmVhIG9uIEdvb2dsZSBNYXBzJyBocmVmPSdodHRwOi8vbWFwcy5nb29nbGUuY28udWsvbWFwcz9zb3VyY2VpZD1uYXZjbGllbnQmYW1wO2llPVVURi04JmFtcDtybHo9MVQ0R0ZSQ19lbkdCMjIxR0IyMjImYW1wO3E9U0ExMCA3RE4nPjxpbWcgaGVpZ2h0PSIxNCIgYWx0PSdMb2NhdGUuLi4nIHNyYz0naW1hZ2VzL3NlYXJjaF9pY29uLmdpZicgd2lkdGg9IjEzIj4gU0ExMCA3RE48L2E+PC90ZD48L3RyPlg8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5CdXNpbmVzcyBQYXJrOjwvdGg+PHRkPkFiYmV5IFJvYWQgSW5kdXN0cmlhbCBFc3RhdGU8L3RkPjwvdHI+Rjx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPlRlbGVwaG9uZTo8L3RoPjx0ZD4oMDE2MzkpIDYzNzAwMDwvdGQ+PC90cj4AAEA8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5GYXg6PC90aD48dGQ+KDAxNjM5KSA2MjA3MDE8L3RkPjwvdHI+AEE8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5FbXBsb3llZSBSYW5nZTo8L3RoPjx0ZD42LTEwPC90ZD48L3RyPkc8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5NYWluIENvbnRhY3Q6PC90aD48dGQ+TXIgUCBHaXR0ZW5zPC90ZD48L3RyPgBkAgEPFgIfBQICFgZmD2QWAmYPFQERQ29tcGFueSBBY3Rpdml0eTpkAgEPZBYCZg8VAQxKb2luZXJ5IFdvcmtkAgIPZBYCZg8VAS5XaW5kb3dzICZhbXA7IERvb3JzIC0gV29vZCAoU2VlIEpvaW5lcnkgTWFudWYpZAIED2QWBGYPFQ0DMjI2FkV2ZXJnbGFkZSBVUFZDIFdpbmRvd3NrPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+QWRkcmVzczo8L3RoPjx0ZD5Vbml0IDYsPGJyIC8+QWJiZXkgUm9hZCBJbmR1c3RyaWFsIEVzdGF0ZSw8YnIgLz5OZWF0aDwvdGQ+PC90cj6nAjx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPlBvc3Rjb2RlOjwvdGg+PHRkPjxhIHRpdGxlPSdWaWV3IHRoaXMgYXJlYSBvbiBHb29nbGUgTWFwcycgaHJlZj0naHR0cDovL21hcHMuZ29vZ2xlLmNvLnVrL21hcHM/c291cmNlaWQ9bmF2Y2xpZW50JmFtcDtpZT1VVEYtOCZhbXA7cmx6PTFUNEdGUkNfZW5HQjIyMUdCMjIyJmFtcDtxPVNBMTAgN0ROJz48aW1nIGhlaWdodD0iMTQiIGFsdD0nTG9jYXRlLi4uJyBzcmM9J2ltYWdlcy9zZWFyY2hfaWNvbi5naWYnIHdpZHRoPSIxMyI+IFNBMTAgN0ROPC9hPjwvdGQ+PC90cj5YPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+QnVzaW5lc3MgUGFyazo8L3RoPjx0ZD5BYmJleSBSb2FkIEluZHVzdHJpYWwgRXN0YXRlPC90ZD48L3RyPkQ8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5UZWxlcGhvbmU6PC90aD48dGQ+MDE2MzkgNjQ1NDAwPC90ZD48L3RyPgC8ATx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPkVtYWlsOjwvdGg+PHRkPjxhIGhyZWY9J21haWx0bzpzYWxlc0BldmVyZ2xhZGV3aW5kb3dzLmNvLnVrOyBqb2huQGV2ZXJnbGFkZXdpbmRvd3MuY28udWsnPnNhbGVzQGV2ZXJnbGFkZXdpbmRvd3MuY28udWs7IGpvaG5AZXZlcmdsYWRld2luZG93cy5jby51azwvYT48L3RkPjwvdHI+Pjx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPkZheDo8L3RoPjx0ZD4wMTYzOSA2NDQ2NjQ8L3RkPjwvdHI+gAE8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5XZWJzaXRlOjwvdGg+PHRkPjxhIGhyZWY9J2h0dHA6Ly93d3cuZXZlcmdsYWRld2luZG93cy5jby51ayc+d3d3LmV2ZXJnbGFkZXdpbmRvd3MuY28udWs8L2E+PC90ZD48L3RyPkE8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5FbXBsb3llZSBSYW5nZTo8L3RoPjx0ZD42LTEwPC90ZD48L3RyPkk8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5NYWluIENvbnRhY3Q6PC90aD48dGQ+TXIgSm9obiBIdWdoZXM8L3RkPjwvdHI+ejx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPkRlc2NyaXB0aW9uOjwvdGg+PHRkPlVQVkMgV2luZG93LCBkb29yIGFuZCBjb25zZXJ2YXRvcnkgbWFudWZhY3R1cmUgYW5kIGluc3RhbGxhdGlvbi48L3RkPjwvdHI+ZAIBDxYCHwUCAxYIZg9kFgJmDxUBEUNvbXBhbnkgQWN0aXZpdHk6ZAIBD2QWAmYPFQFAUGxhc3RpYyBEb29ycywgV2luZG93cywgRnJhbWVzLCBUaHJlc2hvbGRzLCBTaHV0dGVycyBBbmQgQmxpbmRzLmQCAg9kFgJmDxUBGldpbmRvd3MgQW5kIFJlbGF0ZWQgSXRlbXMuZAIDD2QWAmYPFQEhV2luZG93cywgRG9vcnMgQW5kIFJlbGF0ZWQgSXRlbXMuZAIFD2QWBGYPFQ0DNDE5H01lY2h3aW5kIFNlcnZpY2VzIChTd2Fuc2VhKSBMdGR+PHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+QWRkcmVzczo8L3RoPjx0ZD5Vbml0IDI0LzI1LDxiciAvPk5lYXRoIEFiYmV5IEJ1c2luZXNzIFBhcmssPGJyIC8+TmVhdGggQWJiZXksPGJyIC8+TmVhdGg8L3RkPjwvdHI+pwI8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5Qb3N0Y29kZTo8L3RoPjx0ZD48YSB0aXRsZT0nVmlldyB0aGlzIGFyZWEgb24gR29vZ2xlIE1hcHMnIGhyZWY9J2h0dHA6Ly9tYXBzLmdvb2dsZS5jby51ay9tYXBzP3NvdXJjZWlkPW5hdmNsaWVudCZhbXA7aWU9VVRGLTgmYW1wO3Jsej0xVDRHRlJDX2VuR0IyMjFHQjIyMiZhbXA7cT1TQTEwIDdEUic+PGltZyBoZWlnaHQ9IjE0IiBhbHQ9J0xvY2F0ZS4uLicgc3JjPSdpbWFnZXMvc2VhcmNoX2ljb24uZ2lmJyB3aWR0aD0iMTMiPiBTQTEwIDdEUjwvYT48L3RkPjwvdHI+WDx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPkJ1c2luZXNzIFBhcms6PC90aD48dGQ+QWJiZXkgUm9hZCBJbmR1c3RyaWFsIEVzdGF0ZTwvdGQ+PC90cj5EPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+VGVsZXBob25lOjwvdGg+PHRkPjAxNzkyIDgxNzYwMzwvdGQ+PC90cj4AAD48dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5GYXg6PC90aD48dGQ+MDE3OTIgODE3NTUzPC90ZD48L3RyPgBCPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+RW1wbG95ZWUgUmFuZ2U6PC90aD48dGQ+MTYtMjA8L3RkPjwvdHI+Rzx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPk1haW4gQ29udGFjdDo8L3RoPjx0ZD5NciBQIFJvYmVydHM8L3RkPjwvdHI+YDx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPkRlc2NyaXB0aW9uOjwvdGg+PHRkPkVsZWN0cmljYWwgYW5kIG1lY2hhbmljYWwgZW5naW5lZXJpbmcuPC90ZD48L3RyPmQCAQ8WAh8FAgQWCmYPZBYCZg8VARFDb21wYW55IEFjdGl2aXR5OmQCAQ9kFgJmDxUBD0NvbnRyb2wgUGFuZWxzLmQCAg9kFgJmDxUBFEVsZWN0cmljYWwgU2VydmljZXMuZAIDD2QWAmYPFQFcUmVwYWlyIEFuZCBNYWludGVuYW5jZSBTZXJ2aWNlcyBPZiBFbGVjdHJpY2FsIE1hY2hpbmVyeSwgQXBwYXJhdHVzIEFuZCBBc3NvY2lhdGVkIEVxdWlwbWVudC5kAgQPZBYCZg8VAS5SZXBhaXIgQW5kIE1haW50ZW5hbmNlIFNlcnZpY2VzIE9mIEdlbmVyYXRvcnMuZAIGD2QWBGYPFQ0DNjQ0JVNwb3J0ZWMgRW1icm9pZGVyeSAmYW1wOyBQcmludGluZyBMdGRrPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+QWRkcmVzczo8L3RoPjx0ZD5Vbml0IDUsPGJyIC8+QWJiZXkgUm9hZCBJbmR1c3RyaWFsIEVzdGF0ZSw8YnIgLz5OZWF0aDwvdGQ+PC90cj6nAjx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPlBvc3Rjb2RlOjwvdGg+PHRkPjxhIHRpdGxlPSdWaWV3IHRoaXMgYXJlYSBvbiBHb29nbGUgTWFwcycgaHJlZj0naHR0cDovL21hcHMuZ29vZ2xlLmNvLnVrL21hcHM/c291cmNlaWQ9bmF2Y2xpZW50JmFtcDtpZT1VVEYtOCZhbXA7cmx6PTFUNEdGUkNfZW5HQjIyMUdCMjIyJmFtcDtxPVNBMTAgN0ROJz48aW1nIGhlaWdodD0iMTQiIGFsdD0nTG9jYXRlLi4uJyBzcmM9J2ltYWdlcy9zZWFyY2hfaWNvbi5naWYnIHdpZHRoPSIxMyI+IFNBMTAgN0ROPC9hPjwvdGQ+PC90cj5YPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+QnVzaW5lc3MgUGFyazo8L3RoPjx0ZD5BYmJleSBSb2FkIEluZHVzdHJpYWwgRXN0YXRlPC90ZD48L3RyPkQ8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5UZWxlcGhvbmU6PC90aD48dGQ+MDE2MzkgNjMyMjUwPC90ZD48L3RyPgBwPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+RW1haWw6PC90aD48dGQ+PGEgaHJlZj0nbWFpbHRvOnNhbGVzQHNwb3J0ZWMuY28udWsnPnNhbGVzQHNwb3J0ZWMuY28udWs8L2E+PC90ZD48L3RyPj48dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5GYXg6PC90aD48dGQ+MDE2MzkgNjQ1MjIyPC90ZD48L3RyPm48dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5XZWJzaXRlOjwvdGg+PHRkPjxhIGhyZWY9J2h0dHA6Ly93d3cuc3BvcnRlYy5jby51ayc+d3d3LnNwb3J0ZWMuY28udWs8L2E+PC90ZD48L3RyPkA8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5FbXBsb3llZSBSYW5nZTo8L3RoPjx0ZD4xLTU8L3RkPjwvdHI+Szx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPk1haW4gQ29udGFjdDo8L3RoPjx0ZD5NciBTdGV2ZW4gTWFydGluPC90ZD48L3RyPpwBPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+RGVzY3JpcHRpb246PC90aD48dGQ+RW1icm9pZGVyeSAmYW1wOyBHYXJtZW50IHByaW50aW5nLCBNYW51ZmFjdHVyZXMgb2Ygc3BvcnRzd2VhciwgVGVhbSBraXQsIExlaXN1cmV3ZWFyLCBTY2hvb2wgd2Vhci48L3RkPjwvdHI+ZAIBDxYCHwUCCBYSZg9kFgJmDxUBEUNvbXBhbnkgQWN0aXZpdHk6ZAIBD2QWAmYPFQETQ29ycG9yYXRlIENsb3RoaW5nLmQCAg9kFgJmDxUBDEVtYnJvaWRlcmVyc2QCAw9kFgJmDxUBEU1lZGljYWwgQ2xvdGhpbmcuZAIED2QWAmYPFQE4T2NjdXBhdGlvbmFsIENsb3RoaW5nLCBTcGVjaWFsIFdvcmt3ZWFyIEFuZCBBY2Nlc3Nvcmllcy5kAgUPZBYCZg8VARZPY2N1cGF0aW9uYWwgQ2xvdGhpbmcuZAIGD2QWAmYPFQEMU3dlYXRzaGlydHMuZAIHD2QWAmYPFQEPVGV4dGlsZSBCYWRnZXMuZAIID2QWAmYPFQEJVW5pZm9ybXMuZAIHD2QWBGYPFQ0EMTY5OSJXQVRUUyBJTkRVU1RSSUFMIFRZUkUgU0VSVklDRVMgTFREazx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPkFkZHJlc3M6PC90aD48dGQ+VW5pdCAyLDxiciAvPkFiYmV5IFJvYWQgSW5kdXN0cmlhbCBFc3RhdGUsPGJyIC8+TmVhdGg8L3RkPjwvdHI+pwI8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5Qb3N0Y29kZTo8L3RoPjx0ZD48YSB0aXRsZT0nVmlldyB0aGlzIGFyZWEgb24gR29vZ2xlIE1hcHMnIGhyZWY9J2h0dHA6Ly9tYXBzLmdvb2dsZS5jby51ay9tYXBzP3NvdXJjZWlkPW5hdmNsaWVudCZhbXA7aWU9VVRGLTgmYW1wO3Jsej0xVDRHRlJDX2VuR0IyMjFHQjIyMiZhbXA7cT1TQTEwIDdETic+PGltZyBoZWlnaHQ9IjE0IiBhbHQ9J0xvY2F0ZS4uLicgc3JjPSdpbWFnZXMvc2VhcmNoX2ljb24uZ2lmJyB3aWR0aD0iMTMiPiBTQTEwIDdETjwvYT48L3RkPjwvdHI+WDx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPkJ1c2luZXNzIFBhcms6PC90aD48dGQ+QWJiZXkgUm9hZCBJbmR1c3RyaWFsIEVzdGF0ZTwvdGQ+PC90cj5EPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+VGVsZXBob25lOjwvdGg+PHRkPjAxNjM5IDYzMzI0NzwvdGQ+PC90cj4AAD48dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5GYXg6PC90aD48dGQ+MDE2MzkgNjMzMjQ3PC90ZD48L3RyPoIBPHRyPjx0aCBzdHlsZT0nd2lkdGg6MzAlOyc+V2Vic2l0ZTo8L3RoPjx0ZD48YSBocmVmPSdodHRwOi8vd3d3LndhdHRzdHlyZXNlcnZpY2VzLmNvLnVrJz53d3cud2F0dHN0eXJlc2VydmljZXMuY28udWs8L2E+PC90ZD48L3RyPkA8dHI+PHRoIHN0eWxlPSd3aWR0aDozMCU7Jz5FbXBsb3llZSBSYW5nZTo8L3RoPjx0ZD4xLTU8L3RkPjwvdHI+RTx0cj48dGggc3R5bGU9J3dpZHRoOjMwJTsnPk1haW4gQ29udGFjdDo8L3RoPjx0ZD5QUk9QUklFVE9SPC90ZD48L3RyPgBkAgEPFgIfBQIBFgRmD2QWAmYPFQERQ29tcGFueSBBY3Rpdml0eTpkAgEPZBYCZg8VARtUeXJlcyBBbmQgUmVsYXRlZCBQcm9kdWN0cy5kAg4PZBYCZg9kFgJmD2QWBGYPFgIeCWN1clBhZ2VObwIBFgRmD2QWAmYPFQEAZAIBD2QWAmYPFQEAZAIBDxYCHwYCAWQCEA9kFgQCAg8WAh8BZWQCCA9kFgJmD2QWHGYPFgIfAQXFDjxkaXYgaWQ9ImZiLXJvb3QiPjwvZGl2Pg0KPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPg0KICAgICAvLzwhW0NEQVRBWw0KICAgICAgICAgd2luZG93LmZiQXN5bmNJbml0ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgRkIuaW5pdCh7c3RhdHVzIDogdHJ1ZSwgbG9nZ2luZyA6IHRydWUsIGNvb2tpZSA6IGZhbHNlLCB4ZmJtbCA6IHRydWV9KTsNCiAgICAgICAgICAgICAgRkIuRXZlbnQuc3Vic2NyaWJlKCdjb21tZW50LmNyZWF0ZScsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7DQogICAgIAkgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOw0KICAgICAJICAgICAgICAgICAgdmFyIHVybD0iaHR0cDovL3d3dy5ucHQuZ292LnVrL2ZiY29tbWVudC5hc3B4IjsNCiAgICAgCSAgICAgICAgICAgIHZhciBwYXJhbWV0ZXJzID0gInVybD0iICsgZXNjYXBlKHJlc3BvbnNlLmhyZWYpICsgIiZjb21tZW50SUQ9IiArIGVzY2FwZShyZXNwb25zZS5jb21tZW50SUQpOw0KICAgICAJICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCJQT1NUIiwgdXJsLCB0cnVlKTsNCiAgICAgCSAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC10eXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOw0KICAgICAJICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LWxlbmd0aCIsIHBhcmFtZXRlcnMubGVuZ3RoKTsNCiAgICAgCSAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29ubmVjdGlvbiIsICJjbG9zZSIpOw0KICAgICAJICAgICAgICAgICAgeG1sSHR0cC5zZW5kKHBhcmFtZXRlcnMpOw0KICAgICAJICAgICAgICAgICAgZ2EoJ3NlbmQnLCAnc29jaWFsJywgJ0ZhY2Vib29rJywgJ0NvbW1lbnQnLCByZXNwb25zZS5ocmVmLCAndW5kZWZpbmVkJyk7DQogICAgIAkgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgRkIuRXZlbnQuc3Vic2NyaWJlKCdlZGdlLmNyZWF0ZScsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7DQogICAgIAkgICAgICAgICAgICBnYSgnc2VuZCcsICdzb2NpYWwnLCAnRmFjZWJvb2snLCAnTGlrZScsIHJlc3BvbnNlLmhyZWYsICd1bmRlZmluZWQnKTsNCiAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgRkIuRXZlbnQuc3Vic2NyaWJlKCdlZGdlLnJlbW92ZScsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7DQogICAgIAkgICAgICAgICAgICBnYSgnc2VuZCcsICdzb2NpYWwnLCAnRmFjZWJvb2snLCAnVW5MaWtlJywgcmVzcG9uc2UuaHJlZiwgJ3VuZGVmaW5lZCcpOw0KICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICBGQi5FdmVudC5zdWJzY3JpYmUoJ21lc3NhZ2Uuc2VuZCcsIGZ1bmN0aW9uKHRhcmdldFVybCkgew0KICAgICAJICAgICAgICAgICAgZ2EoJ3NlbmQnLCAnc29jaWFsJywgJ0ZhY2Vib29rJywgJ1NlbmQnLCB0YXJnZXRVcmwsICd1bmRlZmluZWQnKTsNCiAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgIH07DQoNCiAgICAgICAgIChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICB2YXIgZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOw0KICAgICAgICAgICAgIGUuc3JjID0gZG9jdW1lbnQubG9jYXRpb24ucHJvdG9jb2wgKyAnLy9jb25uZWN0LmZhY2Vib29rLm5ldC9lbl9HQi9hbGwuanMnOw0KICAgICAgICAgICAgIGUuYXN5bmMgPSB0cnVlOw0KICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmYi1yb290JykuYXBwZW5kQ2hpbGQoZSk7DQogICAgICAgICB9KCkpOw0KCQkvL11dPg0KPC9zY3JpcHQ+DQpkAgEPFgIfAQWbATxkaXYgY2xhc3M9ImJveG91dCI+PGRpdiBjbGFzcz0iaGVhZCI+PGgxIGNsYXNzPSJ0aXRsZUJhciI+PGEgaHJlZj0iSUxJTkt8NzM1OCx8c2hhcmU9cGFnZSUzZDMyNDQiPlNoYXJlIHRoaXMmbmJzcDsmcmFxdW87PC9hPjwvaDE+PC9kaXY+PGRpdiBjbGFzcz0iYm9keSI+ZAIDDxYCHwEFdzxsaSBpZD0ic2hhcmVCb3hJbnRybyI+PGEgaHJlZj0iSUxJTkt8NzM1OCx8c2hhcmU9cGFnZSUzZDMyNDQiPlNoYXJlIHRoaXM8L2E+PHNwYW4gaWQ9InNoYXJlQm94SW50cm9TZXAiPjogPC9zcGFuPjwvbGk+ZAIID2QWAmYPDxYKHghJbWFnZVVybAUmfi9pbWFnZXMvbnB0VGVtcGxhdGVzL3NtX3R3aXR0ZXIyMC5wbmceBVdpZHRoGwAAAAAAADRAAQAAAB4NT25DbGllbnRDbGljawWjAmNzKCk7IHdpbmRvdy5vcGVuKCdodHRwOi8vdHdpdHRlci5jb20vc2hhcmU/dXJsPWh0dHAlM2ElMmYlMmZ3d3cubnB0LWJ1c2luZXNzLmNvLnVrJTJmZGVmYXVsdC5hc3B4JTNmcGFnZSUzZDMyNDQmdGV4dD1OUFRCdXNpbmVzcyUzYStCdXNpbmVzcytTZWFyY2gmbGFuZz1lbiZjb3VudD12ZXJ0aWNhbCZkbnQ9ZmFsc2UnKTsgZ2EoJ3NlbmQnLCAnZXZlbnQnLCAnU2hhcmUnLCAnVHdpdHRlcicsICdodHRwOi8vd3d3Lm5wdC1idXNpbmVzcy5jby51ay9kZWZhdWx0LmFzcHg/cGFnZT0zMjQ0JywgMCwgZmFsc2UpOx4NQWx0ZXJuYXRlVGV4dAUSU2hhcmUgd2l0aCBUd2l0dGVyHgRfIVNCAoACFgQfBAUwamF2YXNjcmlwdDppZiAoZXZlbnQua2V5Q29kZT09MTMpe3RoaXMuY2xpY2soKTt9HgV0aXRsZQUSU2hhcmUgd2l0aCBUd2l0dGVyZAIJD2QWAmYPDxYEHwkF+QFjcygpOyB3aW5kb3cub3BlbignaHR0cDovL3d3dy5mYWNlYm9vay5jb20vc2hhcmVyLnBocD91PWh0dHAlM2ElMmYlMmZ3d3cubnB0LWJ1c2luZXNzLmNvLnVrJTJmZGVmYXVsdC5hc3B4JTNmcGFnZSUzZDMyNDQmdD1CdXNpbmVzcytTZWFyY2gnKTsgZ2EoJ3NlbmQnLCAnZXZlbnQnLCAnU2hhcmUnLCAnRmFjZWJvb2snLCAnaHR0cDovL3d3dy5ucHQtYnVzaW5lc3MuY28udWsvZGVmYXVsdC5hc3B4P3BhZ2U9MzI0NCcsIDAsIGZhbHNlKTsfCgUTU2hhcmUgd2l0aCBGYWNlYm9vaxYEHwQFMGphdmFzY3JpcHQ6aWYgKGV2ZW50LmtleUNvZGU9PTEzKXt0aGlzLmNsaWNrKCk7fR8MBRNTaGFyZSB3aXRoIEZhY2Vib29rZAIKD2QWAmYPDxYEHwkF5gFjcygpOyB3aW5kb3cub3BlbignaHR0cHM6Ly9wbHVzLmdvb2dsZS5jb20vc2hhcmU/dXJsPWh0dHAlM2ElMmYlMmZ3d3cubnB0LWJ1c2luZXNzLmNvLnVrJTJmZGVmYXVsdC5hc3B4JTNmcGFnZSUzZDMyNDQnKTsgZ2EoJ3NlbmQnLCAnZXZlbnQnLCAnU2hhcmUnLCAnR29vZ2xlUGx1cycsICdodHRwOi8vd3d3Lm5wdC1idXNpbmVzcy5jby51ay9kZWZhdWx0LmFzcHg/cGFnZT0zMjQ0JywgMCwgZmFsc2UpOx8KBRRTaGFyZSBvbiBHb29nbGUgUGx1cxYEHwQFMGphdmFzY3JpcHQ6aWYgKGV2ZW50LmtleUNvZGU9PTEzKXt0aGlzLmNsaWNrKCk7fR8MBRRTaGFyZSBvbiBHb29nbGUgUGx1c2QCCw9kFgJmDw8WBB8JBfUBY3MoKTsgd2luZG93Lm9wZW4oJ2h0dHA6Ly9kZWwuaWNpby51cy9wb3N0P3VybD1odHRwJTNhJTJmJTJmd3d3Lm5wdC1idXNpbmVzcy5jby51ayUyZmRlZmF1bHQuYXNweCUzZnBhZ2UlM2QzMjQ0JnRpdGxlPUJ1c2luZXNzK1NlYXJjaCcpOyBnYSgnc2VuZCcsICdldmVudCcsICdTaGFyZScsICdEZWxpY2lvdXMnLCAnaHR0cDovL3d3dy5ucHQtYnVzaW5lc3MuY28udWsvZGVmYXVsdC5hc3B4P3BhZ2U9MzI0NCcsIDAsIGZhbHNlKTsfCgUXQm9va21hcmsgd2l0aCBEZWxpY2lvdXMWBB8EBTBqYXZhc2NyaXB0OmlmIChldmVudC5rZXlDb2RlPT0xMyl7dGhpcy5jbGljaygpO30fDAUXQm9va21hcmsgd2l0aCBEZWxpY2lvdXNkAgwPZBYCZg8PFgQfCQWBAmNzKCk7IHdpbmRvdy5vcGVuKCdodHRwOi8vd3d3LnN0dW1ibGV1cG9uLmNvbS9zdWJtaXQ/dXJsPWh0dHAlM2ElMmYlMmZ3d3cubnB0LWJ1c2luZXNzLmNvLnVrJTJmZGVmYXVsdC5hc3B4JTNmcGFnZSUzZDMyNDQmdGl0bGU9QnVzaW5lc3MrU2VhcmNoJyk7IGdhKCdzZW5kJywgJ2V2ZW50JywgJ1NoYXJlJywgJ1N0dW1ibGV1cG9uJywgJ2h0dHA6Ly93d3cubnB0LWJ1c2luZXNzLmNvLnVrL2RlZmF1bHQuYXNweD9wYWdlPTMyNDQnLCAwLCBmYWxzZSk7HwoFFlNoYXJlIHdpdGggU3R1bWJsZXVwb24WBB8EBTBqYXZhc2NyaXB0OmlmIChldmVudC5rZXlDb2RlPT0xMyl7dGhpcy5jbGljaygpO30fDAUWU2hhcmUgd2l0aCBTdHVtYmxldXBvbmQCDQ9kFgJmDw8WBB8JBe8BY3MoKTsgd2luZG93Lm9wZW4oJ2h0dHA6Ly9kaWdnLmNvbS9zdWJtaXQ/dXJsPWh0dHAlM2ElMmYlMmZ3d3cubnB0LWJ1c2luZXNzLmNvLnVrJTJmZGVmYXVsdC5hc3B4JTNmcGFnZSUzZDMyNDQmdGl0bGU9QnVzaW5lc3MrU2VhcmNoJyk7IGdhKCdzZW5kJywgJ2V2ZW50JywgJ1NoYXJlJywgJ0RpZ2cnLCAnaHR0cDovL3d3dy5ucHQtYnVzaW5lc3MuY28udWsvZGVmYXVsdC5hc3B4P3BhZ2U9MzI0NCcsIDAsIGZhbHNlKTsfCgUJRGlnZyB0aGlzFgQfBAUwamF2YXNjcmlwdDppZiAoZXZlbnQua2V5Q29kZT09MTMpe3RoaXMuY2xpY2soKTt9HwwFCURpZ2cgdGhpc2QCDg9kFgJmDw8WBB8JBfcBY3MoKTsgd2luZG93Lm9wZW4oJ2h0dHA6Ly93d3cucmVkZGl0LmNvbS9zdWJtaXQ/dXJsPWh0dHAlM2ElMmYlMmZ3d3cubnB0LWJ1c2luZXNzLmNvLnVrJTJmZGVmYXVsdC5hc3B4JTNmcGFnZSUzZDMyNDQmdGl0bGU9QnVzaW5lc3MrU2VhcmNoJyk7IGdhKCdzZW5kJywgJ2V2ZW50JywgJ1NoYXJlJywgJ1JlZGRpdCcsICdodHRwOi8vd3d3Lm5wdC1idXNpbmVzcy5jby51ay9kZWZhdWx0LmFzcHg/cGFnZT0zMjQ0JywgMCwgZmFsc2UpOx8KBRFTaGFyZSB3aXRoIFJlZGRpdBYEHwQFMGphdmFzY3JpcHQ6aWYgKGV2ZW50LmtleUNvZGU9PTEzKXt0aGlzLmNsaWNrKCk7fR8MBRFTaGFyZSB3aXRoIFJlZGRpdGQCDw9kFgJmDw8WBB8JBbsCY3MoKTsgd2luZG93Lm9wZW4oJ2h0dHA6Ly93d3cubGlua2VkaW4uY29tL3NoYXJlQXJ0aWNsZT9taW5pPXRydWUmdXJsPWh0dHAlM2ElMmYlMmZ3d3cubnB0LWJ1c2luZXNzLmNvLnVrJTJmZGVmYXVsdC5hc3B4JTNmcGFnZSUzZDMyNDQmdGl0bGU9QnVzaW5lc3MrU2VhcmNoJnNvdXJjZT1OZWF0aCtQb3J0K1RhbGJvdCtDb3VudHkrQm9yb3VnaCtDb3VuY2lsJyk7IGdhKCdzZW5kJywgJ2V2ZW50JywgJ1NoYXJlJywgJ0xpbmtlZGluJywgJ2h0dHA6Ly93d3cubnB0LWJ1c2luZXNzLmNvLnVrL2RlZmF1bHQuYXNweD9wYWdlPTMyNDQnLCAwLCBmYWxzZSk7HwoFEVNoYXJlIG9uIExpbmtlZEluFgQfBAUwamF2YXNjcmlwdDppZiAoZXZlbnQua2V5Q29kZT09MTMpe3RoaXMuY2xpY2soKTt9HwwFEVNoYXJlIG9uIExpbmtlZEluZAIQDxYCHwEFwQE8bGkgaWQ9InNoYXJlQm94RW1haWwiPjxhIGhyZWY9IklMSU5LfDczNTksfHNoYXJlPXBhZ2UlM2QzMjQ0IiB0aXRsZT0iRW1haWwgdG8gYSBmcmllbmQiPjxpbWcgc3JjPSJpbWFnZXMvbnB0VGVtcGxhdGVzL3NtX2VtYWlsMjAucG5nIiBhbHQ9IkVtYWlsIHRvIGEgZnJpZW5kIiB3aWR0aD0iMjgiIGhlaWdodD0iMjAiIC8+PC9hPjwvbGk+ZAIRDxYCHwEFzwI8bGkgaWQ9InNoYXJlQm94TGlrZSI+DQo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+DQogLy88IVtDREFUQVsNCiAgICAgZG9jdW1lbnQud3JpdGUoJzxmYjpsaWtlIGhyZWY9Imh0dHA6Ly93d3cubnB0LWJ1c2luZXNzLmNvLnVrL2RlZmF1bHQuYXNweD9wYWdlPTMyNDQiIGxheW91dD0iYnV0dG9uX2NvdW50IiBzaG93X2ZhY2VzPSJmYWxzZSIgd2lkdGg9IjkwIiBhY3Rpb249Imxpa2UiIGNvbG9yc2NoZW1lPSJsaWdodCIgZm9udD0gInRhaG9tYSIgcmVmPSJucHRCdXMzMjQ0IiBzZW5kPSJmYWxzZSI+PC9mYjpsaWtlPicpOw0KIC8vXV0+DQo8L3NjcmlwdD4NCg0KPC9saT4NCmQCFg8WAh8BBSw8L2Rpdj48ZGl2IGNsYXNzPSJGb290ZXIiPiZuYnNwOzwvZGl2PjwvZGl2PmQCEQ9kFgICAw9kFgICBQ9kFgJmD2QWAgIDD2QWAgIdDw9kFgIfBAUwamF2YXNjcmlwdDppZiAoZXZlbnQua2V5Q29kZT09MTMpe3RoaXMuY2xpY2soKTt9ZBgCBR5fX0NvbnRyb2xzUmVxdWlyZVBvc3RCYWNrS2V5X18WCQUfVGVtcGxhdGUkc2hhcmVib3gkaW1nQnRuVHdpdHRlcgUgVGVtcGxhdGUkc2hhcmVib3gkaW1nQnRuRmFjZWJvb2sFIlRlbXBsYXRlJHNoYXJlYm94JGltZ0J0bkdvb2dsZVBsdXMFIVRlbXBsYXRlJHNoYXJlYm94JGltZ0J0bkRlbGljaW91cwUjVGVtcGxhdGUkc2hhcmVib3gkaW1nQnRuU3R1bWJsZXVwb24FHFRlbXBsYXRlJHNoYXJlYm94JGltZ0J0bkRpZ2cFHlRlbXBsYXRlJHNoYXJlYm94JGltZ0J0blJlZGRpdAUgVGVtcGxhdGUkc2hhcmVib3gkaW1nQnRuTGlua2VkaW4FJFRlbXBsYXRlJFJhdGluZ0Zvcm0kaW1nTW9kYWxDbG9zZUJ0bgUZVGVtcGxhdGUkc2hhcmVib3gkbXZTaGFyZQ8PZGZktfURdld5MU/DGEbmBlYhEZbrupI=',
'__VIEWSTATEGENERATOR':'CA0B0334'

}

data = urllib.urlencode(data)

req = urllib2.Request(URL,data, headers)
connection = urllib2.urlopen(req)
HTML = connection.read()
connection.close()

soup = BeautifulSoup(HTML)


#print(soup.prettify())


tables = soup.find_all("table")
#remove first table as is search table
tables.remove(tables[0])

for table in tables:
    details = ""
    cols = ""
    rows = table.find_all('tr')
    comps = table.find_all('caption')
    for c in comps:
        companyName = c.get_text(strip=True)
        details = companyName + ','
        cols = 'Company Name,'
        print(companyName)
    for row in rows:
        data = row.find_all('td')
        names = row.find_all('th')
        for d in data:
            details = details + d.get_text(strip=True) + ','
        for n in names:
            cols = cols + n.get_text(strip=True) + ','
    if len(Companies) != 0:

        Companies.append([details])
    else:
        Companies.append([cols])
        Companies.append([unicodedata.normalize('NFKD', details)])


with open("TravelToWork_NPT.csv", "wb") as f:
                writer = csv.writer(f, encoding='utf-8')
                writer.writerows(Companies)



